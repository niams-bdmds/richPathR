# richPathR

## BACKGROUND

Gene set enrichment analysis (GSEA) is an important step for disease and drug
discovery. Omics profiling of tissue or cells of patients and healthy
individuals generated gene lists that need to be further investigated in the
known biological context. Multiple public data sources with annotated gene sets
are available for GSEA and enrichR is the most popular web application still
requiring custom tool for large-scale mining. richPathR package is a collection
of the R functions that helps researchers with enrichment analysis using EnrichR.

## DEPENDENCIES

This package has been developed using following version of R and R packages,
therefore we recommend using these or later versions:

```
1. dplyr(1.0.8)
2. enrichR(3.0)
3. filestrings(3.2.2)
4. ggplot2(3.3.5)
5. pheatmap(1.0.12)
6. plotly(4.10.0)
7. purrr(0.3.4)
8. readxl(1.4.0)
9. tidyr(1.2.0)
10. xlsx(0.6.5)
11. R(4.1.3)
12. devtools(2.4.3) only developer needs this package
13. roxygen2(7.2.0) only developer needs this package
```

### INSTALLATION

Package can be installed directly from github (https://github.com/niams-bdmds/richPathR).

```

```

### TEST DATA

Test data are available in /Data.

### CALL ALL REQUIRED PACKAGE

Make sure the above packes are available in your computer. For calling all these
packages, the following function can be implemented:

call_required_packages()

NOTE: check vignette for detail explanation.

# richPathR Tutorial

### 1. Download and install the package

This package can be downloaded from GitHub account:
https://github.com/niams-bdmds/richPathR and installed locally or it can be
installed directly from the GitHub.

```
install(devtools)
Install_github("niams-bdmds/richPathR")
```

### 2. Required packages and dependencies

This package was written in MacBookPro 2019 and tested in Windows. Make
sure the following packages are up to date in your computing environment.
Install the following or later versions of the R packages.

```
1. dplyr(1.0.8)
2. enrichR(3.0)
3. filestrings(3.2.2)
4. ggplot2(3.3.5)
5. pheatmap(1.0.12)
6. plotly(4.10.0)
7. purrr(0.3.4)
8. readxl(1.4.0)
9. tidyr(1.2.0)
10. xlsx(0.6.5)
11. R(4.1.3)

```

The following versions of R development tools were used to write this package

```

9. devtools(2.4.3)
10. roxygen2(7.2.0)

```

The easiest way of calling the required package is using the following function.
Run the following command:

```

call_required_packages()

```

### 3. Obtaining the most recent database from **_enrichr_**

It is highly recommended to download the current database from enrichr
web application. Use the following command to obtain the library database.
It implements listEnrichrDbs functionality hosted in enrichr package.

```

db_EnrichR_lib()

```

This command will yield a table something like this:

### 4. Implementing **_enrichr_** and generating two data frames

Put the csv file of gene set to be explored in /data dir. Any number of gene
sets and libraries can be used as input for implementing this package and
quickly obtaining large data frames and generate tables of the most
common and unique terms. However, for visualizations purpose, we
recommend a maximum of five gene sets and an equal number of libraries.
First specify the list of database libraries of interest as follows.

```

dbs <- c("Cancer_Cell_Line_Encyclopedia", "NCI-60_Cancer_Cell_Lines", "NCI-Nature_2016", "UK_Biobank_GWAS_v1",
"KEGG_2021_Human")

```

Use the following command to implement enrichr plug in to obtain the excel
files. The output of this command will generate /results directory in /data
directory. For each gene list, the result directory contains a separate excel
file. For each library, there is a separate sheet in the file.

```

implement_enrichr(dbs=dbs, gene_list = "data/prc_gene_set.csv")

```

The following two commands will generate the data frames, the second
command will generate the larger data frame.

```

\_enrichr_df <- enrichr_df()
expanded_enrichr_df <- expanded_enrichr_df()

```

### 5. Visualization

Obtaining the large data frame and generating the most unique and
ubiquitous terms are very useful functions of this package. Once a data
frame with multiple gene lists and libraries is obtained, the users can use
their script for visualizations. The followings are the exploratory
visualization tools provided in the package.

#### a. Bar plots

Use the following function to generate a bar plot of term count distributed
across the gene list and libraries. The minimum_combined score can be any
positive integer, the default is 5. Make sure enrichr_df generated by
enrichr_df() is available in the computing environment.

```

bar_plot_count(enrichr_df = enrichr_df , minimum_combined_score )

```

Implementing this function generates the plot something like this.

Use the following command to generate a mixed bar plot of the distribution
of counts across gene sets and libraries. The minimum_combined score can
be any positive integer; the default is 5.

```

bar_plot_genelist_library(enrichr_df = enrichr_df,
minimum_combined_score = 5)

```

Use the following command to visualize the top 30 (combined_score
sorted) terms distributed across the gene list. This visualization is
particularly useful to see the unique and common most significant terms
distributed. The minimum_combined score can be any positive integer;
the default is 5.

```

bar_genelist_terms(enrichr_df = enrichr_df, minimum_combined_score)

```

#### b. Violin plots

Use the following function to visualize the log_combined score as the violin
plots. The combined score can be any positive integer, default is 5. This plot
is extremely useful to scan the most significant terms across multiple gene
lists and libraries.

```

_>violin_plot_genelist(enrichr_df = enrichr_df, minimum_combined_score )_

```

Use the following command to generate violin plots split into libraries.

```

violin_plot_genelist_library(enrichr_df = enrichr_df, minimum_combined_score)

```

#### c. Heat map

Use the following command to generate the heat map. Before using this
functionality, generate expanded_enrichr_df and make it available in the
computing environment. The minimum_combined score can be any positive
integer; the default is 5. This functionality breaks down genes from the top
30 most significant gene lists and visualizes the top hit genes distributed
across gene lists and libraries.

```

enrichr_heat_map(expanded_enrichr_df = expanded_enrichr_df,
minimum_combined_score)

```

#### d. Tile plot

To explore which gene lists hit most in which library, use the tile*plot
function. Before implementing this function, expanded \_enrichr* data frame
should be available in computing environment. The minimum_combined
score can be any positive integer; the default is 5.

```

> tille_plot(expanded_enrichr_df = expanded_enrichr_df,
> minimum_combined_score )

```

### 6. Generating tables

This is very useful function to explore the unique terms distributed across
multiple gene list and libraries. Before implementing this function _, enrichr_ data
frame should be available in the computing environment. The combined score
can be any positive integer, the default is 5. This table contains more rows than
generating ubiquitous terms because all the terms with count one are listed in
this table which is usually more than the max count.

```

enrichr_unique_terms(enrichr_df = enrichr_df, minimum_combined_score)

```

This is a very useful function to explore the most ubiquitous terms
distributed across multiple gene lists and libraries. Before implementing this
function, _enrichr_ data frame should be available in the computing
environment. The combined score can be any positive integer, the default is 5.

The terms listed in the table are screened based on max(). Therefore, this
table yields one or few rows.

```

enrichr_ubiquitous_terms(enrichr_df = enrichr_df, minimum_combined_score)

```

```

```
